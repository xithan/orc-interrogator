@page "/"
@page "/start"
@page "/prison/{Prison}"

@using Interrogator.Game
@using Interrogator.Game.Setup
@using System.Text.Json.Serialization
<div class="d-flex justify-content-center w-100">
    <h1>Orc Interrogator</h1>
</div>
<Wheel>
    <a class="btn btn-purple start d-flex justify-content-center align-items-center" href="interrogate">Start</a>
</Wheel>
<div class="d-flex justify-content-center align-items-center title-row">
    <h3>Prisoners</h3>
</div>
<div class="d-flex justify-content-center align-items-center">
    @if (PrisonManager.ActivePrison != null)
    {
        foreach (var prisoner in PrisonManager.ActivePrison.Prisoners)
        {
            <div class="prisoner-container">
                <svg class="prisoner-icon">
                    <use href="/icons.svg#optano-logo-purple"></use>
                </svg>
                <div class="prisoner">@prisoner.Name</div>
            </div>
        }
    }
</div>


@code {
    [Parameter]
    public string Prison { get; set; }
    
    [Inject]
    private PrisonManager PrisonManager { get; set; }
    
    [Inject]
    private Loader Loader { get; set; }

    protected override async Task OnParametersSetAsync()
    {
        base.OnParametersSetAsync();
        var prison = await Loader.LoadPrison(this.Prison);
        this.PrisonManager.InitializeNewGame(prison);
    }
}